import request from '@/utils/request';

// 漏洞类型列表
export async function getVulnType(params) {
    return request.get('vulnerability/getTypeList',{params}).then(res=>{
        res.data =  res.data.map(item=>({name:item,id:item}))
        return res
    })
}
// 漏洞列表
export async function getVulnerabilitys(params) {
    return request.get('vulnerabilitys',{params})
}
// 漏洞详情
export async function getVulnerabilityDetail(id) {
    return request.get(`vulnerability/${id}`)
}
// 新增漏洞
export async function insertVulnerability(params) {
    return request.post(`vulnerability/insert`,params)
}
// 编辑漏洞
export async function editVulnerability(params) {
    const {id,...rest}=params
    return request.post(`vulnerability/edit/${id}`,rest)
}
//漏洞导出
export function exportsVulnerability(params={}){
    return request.get('/vulnerability/export',{params,responseType:'blob'});
}
//漏洞导出
export function exportsCpeVulnerability(params={}){
    return request.get('/vulnerability/cpeExport',{params,responseType:'blob'});
}
// // 漏洞详情
// export async function setVulnerabilityVehicleRelated(id,isVehicleRelated) {
//     return request.post(`vulnerability/${id}/vehicleRelated`,{isVehicleRelated})
// }
